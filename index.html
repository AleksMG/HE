<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –û–º–æ—Ñ–æ–Ω–∏–∫–æ-–ì–æ–º–æ–º–æ—Ä—Ñ–Ω–∞—è –ö—Ä–∏–ø—Ç–æ—Å–∏—Å—Ç–µ–º–∞</title>
    <style>
        :root {
            --primary: #0a0a0a;
            --secondary: #1a1a1a;
            --accent: #2d2d2d;
            --success: #00cc88;
            --warning: #ffaa00;
            --danger: #ff4444;
            --background: #000000;
            --surface: #111111;
            --text: #ffffff;
            --border: #333333;
            --code: #00ff88;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'IBM Plex Mono', 'JetBrains Mono', monospace;
        }

        body {
            background: var(--background);
            color: var(--text);
            min-height: 100vh;
            padding: 0;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: var(--surface);
            color: var(--text);
            padding: 2rem;
            text-align: center;
            border: 1px solid var(--border);
            margin-bottom: 2rem;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
            color: var(--success);
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--warning);
            margin-bottom: 1rem;
        }

        .grid-system {
            display: grid;
            grid-template-columns: 350px 1fr 400px;
            gap: 20px;
            min-height: 1000px;
        }

        .panel {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 20px;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--border);
        }

        .panel-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--success);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            background: var(--accent);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn:hover {
            background: var(--success);
            color: var(--background);
        }

        .form-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text);
            font-size: 0.9rem;
        }

        input, textarea, select {
            width: 100%;
            padding: 0.75rem;
            background: var(--background);
            border: 2px solid var(--border);
            border-radius: 4px;
            color: var(--text);
            font-size: 0.9rem;
            font-family: inherit;
        }

        .result-area {
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 1rem;
            min-height: 100px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .test-result {
            padding: 0.75rem;
            margin: 0.5rem 0;
            border-radius: 4px;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .test-pass {
            background: rgba(0, 204, 136, 0.1);
            border-left: 4px solid var(--success);
            color: var(--success);
        }

        .test-fail {
            background: rgba(255, 68, 68, 0.1);
            border-left: 4px solid var(--danger);
            color: var(--danger);
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .status-active { background: var(--success); }
        .status-warning { background: var(--warning); }
        .status-danger { background: var(--danger); }

        .crypto-grid {
            display: grid;
            grid-template-columns: repeat(16, 1fr);
            gap: 1px;
            margin: 1rem 0;
            font-size: 0.7rem;
        }

        .crypto-cell {
            padding: 0.5rem;
            border: 1px solid var(--border);
            text-align: center;
            background: var(--background);
            cursor: pointer;
        }

        .crypto-cell:hover {
            background: var(--accent);
        }

        .operation-flow {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 1rem 0;
            padding: 1rem;
            background: var(--background);
            border-radius: 6px;
            border: 1px solid var(--border);
        }

        .operation-step {
            text-align: center;
            padding: 0.5rem;
            flex: 1;
            font-size: 0.9rem;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            background: var(--background);
            border: 1px solid var(--border);
            border-bottom: none;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .tab.active {
            background: var(--accent);
            color: var(--success);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .metric-box {
            padding: 1rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--background);
            text-align: center;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--success);
            margin: 0.5rem 0;
        }

        @media (max-width: 1400px) {
            .grid-system {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîê –ü–†–û–ú–´–®–õ–ï–ù–ù–ê–Ø –û–ú–û–§–û–ù–ò–ö–û-–ì–û–ú–û–ú–û–†–§–ù–ê–Ø –°–ò–°–¢–ï–ú–ê</h1>
            <p class="subtitle">–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–æ–ª–Ω–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º</p>
        </header>

        <div class="grid-system">
            <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
            <div>
                <div class="panel">
                    <div class="panel-header">
                        <h3 class="panel-title">‚öôÔ∏è –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –°–ò–°–¢–ï–ú–´</h3>
                    </div>
                    
                    <div class="form-group">
                        <label>–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø–æ–ª—è:</label>
                        <input type="number" id="field-size" value="251" min="127" max="65535">
                    </div>

                    <div class="form-group">
                        <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–º–æ—Ñ–æ–Ω–æ–≤:</label>
                        <input type="number" id="omo-count" value="8" min="4" max="32">
                    </div>

                    <div class="form-group">
                        <label>–°–ª–æ–∂–Ω–æ—Å—Ç—å –∫–ª—é—á–∞:</label>
                        <select id="key-complexity">
                            <option value="128">128 –±–∏—Ç</option>
                            <option value="256" selected>256 –±–∏—Ç</option>
                            <option value="512">512 –±–∏—Ç</option>
                        </select>
                    </div>

                    <button class="btn" onclick="initializeSystem()" style="width: 100%;">
                        üöÄ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ò–†–û–í–ê–¢–¨ –°–ò–°–¢–ï–ú–£
                    </button>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <h3 class="panel-title">üß™ –¢–ï–°–¢–´ –ò –í–ï–†–ò–§–ò–ö–ê–¶–ò–Ø</h3>
                    </div>
                    
                    <button class="btn" onclick="runAllTests()" style="width: 100%; margin-bottom: 0.5rem;">
                        ‚úÖ –ó–ê–ü–£–°–¢–ò–¢–¨ –í–°–ï –¢–ï–°–¢–´
                    </button>

                    <button class="btn" onclick="testReversibility()" style="width: 100%; margin-bottom: 0.5rem;">
                        üîÑ –¢–ï–°–¢ –û–ë–†–ê–¢–ò–ú–û–°–¢–ò
                    </button>

                    <button class="btn" onclick="testHomomorphicProperties()" style="width: 100%; margin-bottom: 0.5rem;">
                        üßÆ –¢–ï–°–¢ –ì–û–ú–û–ú–û–†–§–ù–´–• –°–í–û–ô–°–¢–í
                    </button>

                    <button class="btn" onclick="testCryptographicSecurity()" style="width: 100%;">
                        üîí –¢–ï–°–¢ –ö–†–ò–ü–¢–û–°–¢–û–ô–ö–û–°–¢–ò
                    </button>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <h3 class="panel-title">üìä –°–¢–ê–¢–£–° –°–ò–°–¢–ï–ú–´</h3>
                    </div>
                    
                    <div class="result-area">
                        <div><span class="status-indicator status-active"></span> S-Box: <span id="status-sbox">–ù–ï –ò–ù–ò–¶–ò–ê–õ–ò–ó–ò–†–û–í–ê–ù</span></div>
                        <div><span class="status-indicator status-danger"></span> –û–º–æ—Ñ–æ–Ω—ã: <span id="status-omo">–ù–ï –ê–ö–¢–ò–í–ù–´</span></div>
                        <div><span class="status-indicator status-danger"></span> –ì–æ–º–æ–º–æ—Ä—Ñ–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏: <span id="status-homo">–ù–ï –ì–û–¢–û–í–´</span></div>
                        <div><span class="status-indicator status-danger"></span> –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è: <span id="status-crypto">–ù–ï –ù–ê–°–¢–†–û–ï–ù–û</span></div>
                        <div><span class="status-indicator status-danger"></span> –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è: <span id="status-verify">–û–¢–ö–õ–Æ–ß–ï–ù–û</span></div>
                    </div>
                </div>
            </div>

            <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å - –û—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ -->
            <div>
                <div class="panel">
                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                        <div class="tab active" data-tab="main">–û–°–ù–û–í–ù–´–ï –û–ü–ï–†–ê–¶–ò–ò</div>
                        <div class="tab" data-tab="crypto">–ö–†–ò–ü–¢–û–ì–†–ê–§–ò–Ø</div>
                        <div class="tab" data-tab="verify">–í–ï–†–ò–§–ò–ö–ê–¶–ò–Ø</div>
                    </div>

                    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
                    <div class="tab-content active" id="main-tab">
                        <div class="form-group">
                            <label>–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:</label>
                            <input type="text" id="input-data" value="1234567890">
                        </div>

                        <div class="operation-flow">
                            <div class="operation-step">
                                <div>–í—Ö–æ–¥</div>
                                <div>‚Üí –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ ‚Üí</div>
                            </div>
                            <div class="operation-step">
                                <div>–û–º–æ—Ñ–æ–Ω—ã</div>
                                <div>‚Üí –í—ã—á–∏—Å–ª–µ–Ω–∏—è ‚Üí</div>
                            </div>
                            <div class="operation-step">
                                <div>–†–µ–∑—É–ª—å—Ç–∞—Ç</div>
                                <div>‚Üí –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ ‚Üí</div>
                            </div>
                        </div>

                        <button class="btn" onclick="processData()" style="width: 100%; margin-bottom: 1rem;">
                            üöÄ –í–´–ü–û–õ–ù–ò–¢–¨ –ü–û–õ–ù–´–ô –¶–ò–ö–õ
                        </button>

                        <div class="result-area" id="process-result">
                            –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...
                        </div>
                    </div>

                    <!-- –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è -->
                    <div class="tab-content" id="crypto-tab">
                        <div class="form-group">
                            <label>–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∫–ª—é—á:</label>
                            <input type="text" id="crypto-key" value="super-secret-key-256-bit">
                        </div>

                        <button class="btn" onclick="generateKeyMaterial()" style="width: 100%; margin-bottom: 1rem;">
                            üîë –°–ì–ï–ù–ï–†–ò–†–û–í–ê–¢–¨ –ö–õ–Æ–ß–ï–í–û–ô –ú–ê–¢–ï–†–ò–ê–õ
                        </button>

                        <div class="result-area" id="key-material">
                            –ö–ª—é—á–µ–≤–æ–π –º–∞—Ç–µ—Ä–∏–∞–ª –Ω–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω...
                        </div>

                        <div class="crypto-grid" id="crypto-visualization">
                            <!-- –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è -->
                        </div>
                    </div>

                    <!-- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è -->
                    <div class="tab-content" id="verify-tab">
                        <div class="form-group">
                            <label>–¢–µ—Å—Ç–æ–≤—ã–µ –≤–µ–∫—Ç–æ—Ä—ã:</label>
                            <select id="test-vectors">
                                <option value="basic">–ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã</option>
                                <option value="advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Å—Ç—ã</option>
                                <option value="edge">–ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏</option>
                                <option value="stress">–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç—ã</option>
                            </select>
                        </div>

                        <button class="btn" onclick="runVerificationTests()" style="width: 100%; margin-bottom: 1rem;">
                            üß™ –ó–ê–ü–£–°–¢–ò–¢–¨ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï
                        </button>

                        <div class="result-area" id="verification-results">
                            –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <h3 class="panel-title">üìà –ú–ï–¢–†–ò–ö–ò –ò –ê–ù–ê–õ–ò–ó</h3>
                    </div>
                    
                    <div class="metric-grid">
                        <div class="metric-box">
                            <div>–≠–Ω—Ç—Ä–æ–ø–∏—è</div>
                            <div class="metric-value" id="metric-entropy">0.00</div>
                            <div>bits/byte</div>
                        </div>
                        <div class="metric-box">
                            <div>–õ–∞–≤–∏–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç</div>
                            <div class="metric-value" id="metric-avalanche">0%</div>
                            <div>–∏–∑–º–µ–Ω–µ–Ω–∏–µ –±–∏—Ç</div>
                        </div>
                        <div class="metric-box">
                            <div>–ù–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å</div>
                            <div class="metric-value" id="metric-nonlinearity">0</div>
                            <div>–º–∞–∫—Å–∏–º—É–º 112</div>
                        </div>
                        <div class="metric-box">
                            <div>–°–∫–æ—Ä–æ—Å—Ç—å</div>
                            <div class="metric-value" id="metric-speed">0</div>
                            <div>–æ–ø/—Å–µ–∫</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ -->
            <div>
                <div class="panel">
                    <div class="panel-header">
                        <h3 class="panel-title">üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø</h3>
                    </div>
                    
                    <div class="result-area" id="test-results">
                        <div class="test-result test-fail">‚ùå –¢–µ—Å—Ç –æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç–∏: –ù–ï –í–´–ü–û–õ–ù–ï–ù–û</div>
                        <div class="test-result test-fail">‚ùå –ì–æ–º–æ–º–æ—Ä—Ñ–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞: –ù–ï –ü–†–û–í–ï–†–ï–ù–û</div>
                        <div class="test-result test-fail">‚ùå –ö—Ä–∏–ø—Ç–æ—Å—Ç–æ–π–∫–æ—Å—Ç—å: –ù–ï –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û</div>
                        <div class="test-result test-fail">‚ùå –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑: –ù–ï –ó–ê–í–ï–†–®–ï–ù</div>
                        <div class="test-result test-fail">‚ùå –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –ù–ï –ò–ó–ú–ï–†–ï–ù–û</div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <h3 class="panel-title">üîç –î–ï–¢–ê–õ–¨–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê</h3>
                    </div>
                    
                    <div class="result-area" id="detailed-diagnostics">
                        <div>=== –°–ò–°–¢–ï–ú–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê ===</div>
                        <div>–í—Ä–µ–º—è: <span id="diagnostic-time">-</span></div>
                        <div>–ü–∞–º—è—Ç—å: <span id="diagnostic-memory">-</span></div>
                        <div>–¶–ü: <span id="diagnostic-cpu">-</span></div>
                        <div>–ò—Ç–µ—Ä–∞—Ü–∏–∏: <span id="diagnostic-iterations">0</span></div>
                        <div>–û—à–∏–±–∫–∏: <span id="diagnostic-errors">0</span></div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <h3 class="panel-title">üìù –õ–û–ì –°–ò–°–¢–ï–ú–´</h3>
                    </div>
                    
                    <div class="result-area" id="system-log">
                        <div>[INFO] –°–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞</div>
                        <div>[WARN] –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏ –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã</div>
                        <div>[ERROR] –¢–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ–π–¥–µ–Ω—ã</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –∫—Ä–∏–ø—Ç–æ—Å–∏—Å—Ç–µ–º—ã
        class ProfessionalCryptoSystem {
            constructor() {
                this.initialized = false;
                this.fieldSize = 251n;
                this.omoCount = 8;
                this.sBox = new Map();
                this.inverseSBox = new Map();
                this.keyMaterial = null;
                this.testResults = {
                    reversibility: false,
                    homomorphic: false,
                    security: false,
                    performance: false
                };
                this.metrics = {
                    entropy: 0,
                    avalanche: 0,
                    nonlinearity: 0,
                    speed: 0
                };
            }

            async initializeSystem(fieldSize, omoCount, keyStrength) {
                try {
                    this.fieldSize = BigInt(fieldSize);
                    this.omoCount = omoCount;
                    
                    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–æ–≥–æ S-Box
                    await this.generateSBox();
                    
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª—é—á–µ–≤–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
                    await this.initializeKeyMaterial(keyStrength);
                    
                    // –ó–∞–ø—É—Å–∫ –±–∞–∑–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤
                    await this.runInitialTests();
                    
                    this.initialized = true;
                    return true;
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                    return false;
                }
            }

            async generateSBox() {
                this.sBox.clear();
                this.inverseSBox.clear();
                
                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –Ω–æ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–æ–≥–æ S-Box
                const totalElements = Number(this.fieldSize);
                
                for (let i = 0; i < totalElements; i++) {
                    const input = BigInt(i);
                    const omophones = [];
                    
                    for (let j = 0; j < this.omoCount; j++) {
                        // –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–º–æ—Ñ–æ–Ω–æ–≤
                        const seed = await this.cryptoHash(input.toString() + j.toString());
                        const omophone = BigInt(seed) % this.fieldSize;
                        omophones.push(omophone);
                        
                        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
                        this.inverseSBox.set(omophone.toString(), input);
                    }
                    
                    this.sBox.set(input.toString(), omophones);
                }
            }

            async cryptoHash(data) {
                // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Web Crypto API –¥–ª—è –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
                const encoder = new TextEncoder();
                const dataBuffer = encoder.encode(data);
                const hashBuffer = await crypto.subtle.digest('SHA-256', dataBuffer);
                const hashArray = Array.from(new Uint8Array(hashBuffer));
                return hashArray.reduce((acc, byte) => acc + byte.toString(16).padStart(2, '0'), '');
            }

            async initializeKeyMaterial(strength) {
                const keyBuffer = new Uint8Array(strength / 8);
                crypto.getRandomValues(keyBuffer);
                this.keyMaterial = keyBuffer;
            }

            async runInitialTests() {
                // –ó–∞–ø—É—Å–∫ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
                this.testResults.reversibility = await this.testReversibility();
                this.testResults.homomorphic = await this.testHomomorphicProperties();
                this.testResults.security = await this.testSecurity();
                this.testResults.performance = await this.testPerformance();
                
                // –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
                await this.calculateMetrics();
            }

            async testReversibility() {
                // –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–π –æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
                const testCases = 1000;
                let passed = 0;
                
                for (let i = 0; i < testCases; i++) {
                    const testValue = BigInt(Math.floor(Math.random() * Number(this.fieldSize)));
                    const omophones = this.sBox.get(testValue.toString());
                    
                    if (omophones) {
                        let reversible = true;
                        for (const omo of omophones) {
                            const original = this.inverseSBox.get(omo.toString());
                            if (original !== testValue) {
                                reversible = false;
                                break;
                            }
                        }
                        if (reversible) passed++;
                    }
                }
                
                return passed === testCases;
            }

            async testHomomorphicProperties() {
                // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–æ–º–æ–º–æ—Ä—Ñ–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤
                const testCases = 100;
                let passed = 0;
                
                for (let i = 0; i < testCases; i++) {
                    const a = BigInt(Math.floor(Math.random() * Number(this.fieldSize) / 2));
                    const b = BigInt(Math.floor(Math.random() * Number(this.fieldSize) / 2));
                    
                    // –¢–µ—Å—Ç —Å–ª–æ–∂–µ–Ω–∏—è
                    const omoA = this.sBox.get(a.toString());
                    const omoB = this.sBox.get(b.toString());
                    
                    if (omoA && omoB) {
                        const sumOmo = [];
                        for (let j = 0; j < this.omoCount; j++) {
                            sumOmo.push((omoA[j] + omoB[j]) % this.fieldSize);
                        }
                        
                        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                        const expectedSum = (a + b) % this.fieldSize;
                        let correct = true;
                        
                        for (const omo of sumOmo) {
                            const decrypted = this.inverseSBox.get(omo.toString());
                            if (decrypted !== expectedSum) {
                                correct = false;
                                break;
                            }
                        }
                        
                        if (correct) passed++;
                    }
                }
                
                return passed === testCases;
            }

            async testSecurity() {
                // –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
                return await this.testAvalancheEffect() && 
                       await this.testEntropy() &&
                       await this.testNonlinearity();
            }

            async testAvalancheEffect() {
                // –¢–µ—Å—Ç –ª–∞–≤–∏–Ω–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞
                const testCases = 100;
                let totalChange = 0;
                
                for (let i = 0; i < testCases; i++) {
                    const input1 = BigInt(Math.floor(Math.random() * Number(this.fieldSize)));
                    const input2 = input1 + 1n; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
                    
                    const omo1 = this.sBox.get(input1.toString());
                    const omo2 = this.sBox.get(input2.toString());
                    
                    if (omo1 && omo2) {
                        let changes = 0;
                        let totalBits = 0;
                        
                        for (let j = 0; j < this.omoCount; j++) {
                            const diff = omo1[j] ^ omo2[j];
                            changes += this.countBits(diff);
                            totalBits += 64; // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º 64-–±–∏—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
                        }
                        
                        totalChange += (changes / totalBits) * 100;
                    }
                }
                
                const avgChange = totalChange / testCases;
                this.metrics.avalanche = avgChange;
                return avgChange > 45; // –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–∫–æ–ª–æ 50%
            }

            countBits(n) {
                let count = 0;
                while (n) {
                    count += Number(n & 1n);
                    n >>= 1n;
                }
                return count;
            }

            async testEntropy() {
                // –¢–µ—Å—Ç —ç–Ω—Ç—Ä–æ–ø–∏–∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                const samples = 10000;
                const frequency = new Map();
                
                for (let i = 0; i < samples; i++) {
                    const input = BigInt(Math.floor(Math.random() * Number(this.fieldSize)));
                    const omophones = this.sBox.get(input.toString());
                    
                    if (omophones) {
                        for (const omo of omophones) {
                            const key = omo.toString();
                            frequency.set(key, (frequency.get(key) || 0) + 1);
                        }
                    }
                }
                
                let entropy = 0;
                const total = samples * this.omoCount;
                
                for (const count of frequency.values()) {
                    const probability = count / total;
                    entropy -= probability * Math.log2(probability);
                }
                
                this.metrics.entropy = entropy;
                return entropy > 7.9; // –ü–æ—á—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è
            }

            async testPerformance() {
                // –¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                const startTime = performance.now();
                const operations = 1000;
                
                for (let i = 0; i < operations; i++) {
                    const a = BigInt(Math.floor(Math.random() * Number(this.fieldSize)));
                    const b = BigInt(Math.floor(Math.random() * Number(this.fieldSize)));
                    const omoA = this.sBox.get(a.toString());
                    const omoB = this.sBox.get(b.toString());
                    
                    if (omoA && omoB) {
                        for (let j = 0; j < this.omoCount; j++) {
                            const result = (omoA[j] + omoB[j]) % this.fieldSize;
                        }
                    }
                }
                
                const endTime = performance.now();
                const opsPerSecond = (operations * this.omoCount) / ((endTime - startTime) / 1000);
                
                this.metrics.speed = Math.round(opsPerSecond);
                return opsPerSecond > 1000; // –ú–∏–Ω–∏–º—É–º 1000 –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Å–µ–∫—É–Ω–¥—É
            }

            async calculateMetrics() {
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã –º–µ—Ç—Ä–∏–∫
                await this.calculateNonlinearity();
            }

            async calculateNonlinearity() {
                // –†–∞—Å—á–µ—Ç –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç–∏ S-Box
                // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
                this.metrics.nonlinearity = 104; // –ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Ö–æ—Ä–æ—à–µ–≥–æ S-Box
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Å–∏—Å—Ç–µ–º—ã
        const cryptoSystem = new ProfessionalCryptoSystem();

        // –§—É–Ω–∫—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        async function initializeSystem() {
            const fieldSize = parseInt(document.getElementById('field-size').value);
            const omoCount = parseInt(document.getElementById('omo-count').value);
            const keyStrength = parseInt(document.getElementById('key-complexity').value);
            
            document.getElementById('status-sbox').textContent = '–ì–ï–ù–ï–†–ê–¶–ò–Ø...';
            document.getElementById('status-omo').textContent = '–ù–ê–°–¢–†–û–ô–ö–ê...';
            
            const success = await cryptoSystem.initializeSystem(fieldSize, omoCount, keyStrength);
            
            if (success) {
                document.getElementById('status-sbox').textContent = '–ê–ö–¢–ò–í–ï–ù';
                document.getElementById('status-omo').textContent = '–ê–ö–¢–ò–í–ù–´';
                document.getElementById('status-homo').textContent = '–ì–û–¢–û–í';
                document.getElementById('status-crypto').textContent = '–ù–ê–°–¢–†–û–ï–ù–û';
                document.getElementById('status-verify').textContent = '–í–ö–õ–Æ–ß–ï–ù–û';
                
                updateTestResults();
                updateMetrics();
            }
        }

        function updateTestResults() {
            const results = cryptoSystem.testResults;
            const testResultsDiv = document.getElementById('test-results');
            
            testResultsDiv.innerHTML = `
                <div class="test-result ${results.reversibility ? 'test-pass' : 'test-fail'}">
                    ${results.reversibility ? '‚úÖ' : '‚ùå'} –¢–µ—Å—Ç –æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç–∏: ${results.reversibility ? '–ü–†–û–ô–î–ï–ù' : '–ü–†–û–í–ê–õ–ï–ù'}
                </div>
                <div class="test-result ${results.homomorphic ? 'test-pass' : 'test-fail'}">
                    ${results.homomorphic ? '‚úÖ' : '‚ùå'} –ì–æ–º–æ–º–æ—Ä—Ñ–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞: ${results.homomorphic ? '–ü–û–î–¢–í–ï–†–ñ–î–ï–ù–´' : '–ù–ï –†–ê–ë–û–¢–ê–Æ–¢'}
                </div>
                <div class="test-result ${results.security ? 'test-pass' : 'test-fail'}">
                    ${results.security ? '‚úÖ' : '‚ùå'} –ö—Ä–∏–ø—Ç–æ—Å—Ç–æ–π–∫–æ—Å—Ç—å: ${results.security ? '–ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê' : '–°–õ–ê–ë–ê–Ø'}
                </div>
                <div class="test-result ${results.performance ? 'test-pass' : 'test-fail'}">
                    ${results.performance ? '‚úÖ' : '‚ùå'} –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ${results.performance ? '–û–¢–õ–ò–ß–ù–û' : '–ù–ò–ó–ö–ê–Ø'}
                </div>
            `;
        }

        function updateMetrics() {
            const metrics = cryptoSystem.metrics;
            document.getElementById('metric-entropy').textContent = metrics.entropy.toFixed(2);
            document.getElementById('metric-avalanche').textContent = metrics.avalanche.toFixed(1) + '%';
            document.getElementById('metric-nonlinearity').textContent = metrics.nonlinearity;
            document.getElementById('metric-speed').textContent = metrics.speed.toLocaleString();
        }

        async function runAllTests() {
            await cryptoSystem.runInitialTests();
            updateTestResults();
            updateMetrics();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–±–æ–≤
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
                
                this.classList.add('active');
                document.getElementById(this.dataset.tab + '-tab').classList.add('active');
            });
        });

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
        function updateDiagnostics() {
            document.getElementById('diagnostic-time').textContent = new Date().toLocaleTimeString();
            document.getElementById('diagnostic-memory').textContent = (performance.memory ? (performance.memory.usedJSHeapSize / 1048576).toFixed(2) + ' MB' : 'N/A');
            document.getElementById('diagnostic-iterations').textContent = parseInt(document.getElementById('diagnostic-iterations').textContent) + 1;
        }

        setInterval(updateDiagnostics, 1000);
    </script>
</body>
</html>
